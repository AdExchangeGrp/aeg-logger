# language setting
language: node_js

# environment
cache: true

env:
  global:
    - NODE_ENV=development
    - XUNIT_FILE=shippable/testresults/result.xml
    - PROJECT=aeg-logger
    - secure: Gj9L7CJbzIIuqU9kx9SGyzZzKocObl0MXOg/Vy5lFvK0vemHvg7WtQczWWtc/dQHnJyQJ/z41iX0xFkzyPFUpfwbhK+2VAiHobvFMeJlSjaYdpC0F9pAxAVW1opakN3c6U9LLrH5FzipLrhaBGS3zU9ZoIBl8AoWDBNifj/RizUbpz8H3yBuZWO6Od3iOBbBdRvNki2D7SxWXcOHwkNvJPbaz3t99PW4MA3Ku/ZWfj+oU50LMZ1NI3CK3SqzcomF+rsPQ9fHfccuTY6MnhXpINNc/PARsILdKAjoV/S4dZ8wJfH7YHYSmInBWRmbJqf0EXUWES2yq8fDD2dbjiENMA==

# include
branches:
  only:
    - master

# install dependencies
before_install:
  - echo $NPM_TOKEN >> ~/.npmrc
  - shippable_retry npm install

# running the tests and jshint
script:
  - npm run build

# Tell istanbul to generate a coverage report
after_script:
  - ./node_modules/.bin/istanbul cover --dir  shippable/codecoverage/ _mocha -- --recursive test/unit/
  - ./node_modules/.bin/istanbul report cobertura --dir  shippable/codecoverage/